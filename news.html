<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ニュース | ケアステーションソラナ広島</title>
    <meta name="description" content="ケアステーションソラナ広島の最新ニュースをお届けします。">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="nav-container">
                <div class="logo">
                    <a href="index.html">
                        <img src="images/logo.png" alt="ケアステーションソラナ広島" class="logo-image" onerror="this.src='images/logo.jpg'; this.onerror=function(){this.src='images/logo-test.svg'; this.onerror=function(){this.style.display='none'; this.nextElementSibling.style.display='block';}}">
                        <h1 style="display: none;">ケアステーション<span class="logo-accent">ソラナ</span>広島</h1>
                    </a>
                </div>
                <ul class="nav-menu">
                    <li><a href="news.html" class="active">ニュース</a></li>
                    <li><a href="heavy-visit-care.html">重度訪問介護とは</a></li>
                    <li><a href="recruitment.html">求人募集</a></li>
                    <li><a href="index.html#about">事業所概要</a></li>
                    <li><a href="index.html#contact" class="nav-cta">お問い合わせ</a></li>
                </ul>
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </nav>
    </header>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1 class="page-title">ニュース</h1>
            <p class="page-subtitle">News</p>
        </div>
    </section>

    <!-- News Section -->
    <section class="news-section">
        <div class="container">
            <div class="news-list">
                <!-- News Item 1 -->
                <article class="news-item">
                    <div class="news-date">
                        <time datetime="2024-03-15">2024.03.15</time>
                    </div>
                    <div class="news-content">
                        <h2 class="news-title">新スタッフ研修プログラムを開始しました</h2>
                        <p class="news-excerpt">
                            より質の高いサービス提供を目指し、新しいスタッフ研修プログラムを開始いたしました。
                            利用者様一人ひとりのニーズに合わせたケアを提供できるよう、専門知識と技術の向上に努めてまいります。
                        </p>
                        <div class="news-details">
                            <p>
                                この度、ケアステーションソラナ広島では、スタッフの専門性向上を目的とした新しい研修プログラムを導入いたしました。
                                重度訪問介護における最新の技術や知識を習得し、利用者様により安心・安全なサービスを提供できるよう取り組んでおります。
                            </p>
                            <p>
                                研修内容には、コミュニケーション技術の向上、緊急時対応、個別ケアプランの作成方法などが含まれており、
                                定期的な実技演習も実施しております。今後も継続的な教育により、サービス品質の向上に努めてまいります。
                            </p>
                        </div>
                    </div>
                </article>

                <!-- News Item 2 -->
                <article class="news-item">
                    <div class="news-date">
                        <time datetime="2024-02-20">2024.02.20</time>
                    </div>
                    <div class="news-content">
                        <h2 class="news-title">24時間対応体制を強化いたしました</h2>
                        <p class="news-excerpt">${getExcerpt("利用者様とご家族の皆様により安心してサービスをご利用いただけるよう、24時間対応体制をさらに強化いたしました。")}</p>
                        <div class="news-details">
                            <p>
                                緊急時や夜間・休日においても迅速に対応できるよう、連絡体制を見直し、
                                専門スタッフによる24時間サポート体制を整備いたしました。
                            </p>
                            <p>
                                また、定期的な安否確認システムも導入し、利用者様の日常生活をより安全にサポートできる環境を整えております。
                                何かご不明な点やご相談がございましたら、いつでもお気軽にお問い合わせください。
                            </p>
                        </div>
                    </div>
                </article>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <div class="footer-logo-container">
                        <img src="images/logo.png" alt="ケアステーション ソラナ広島" class="footer-logo-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <h3 style="display: none;">ケアステーション<span class="logo-accent">ソラナ</span>広島</h3>
                    </div>
                    <p>ひだまりのような温かさで、皆様の生活をサポートいたします。</p>
                </div>
                <nav class="footer-nav">
                    <ul>
                        <li><a href="news.html">ニュース</a></li>
                        <li><a href="heavy-visit-care.html">重度訪問介護とは</a></li>
                        <li><a href="recruitment.html">求人募集</a></li>
                        <li><a href="index.html#about">事業所概要</a></li>
                        <li><a href="index.html#contact">お問い合わせ</a></li>
                    </ul>
                </nav>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 ケアステーションソラナ広島. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Fixed LINE Icon -->
    <a href="https://lin.ee/k7x7asJ" target="_blank" class="line-fixed-icon" title="LINEでお問い合わせ"></a>

    <script src="script.js"></script>
    <script>
        // microCMS設定
        const NEWS_CONFIG = {
            serviceDomain: 'solana-hiroshima',
            apiKey: 'bj79M3WN9aaimsX660YK3etnSoz53lvgXO4Y',
            endpoint: 'news'
        };

        // 不要な関数を削除（抜粋は使用しない）

        // ニュースデータを取得して表示
        async function loadNewsFromMicroCMS() {
            try {
                const response = await fetch(`https://${NEWS_CONFIG.serviceDomain}.microcms.io/api/v1/${NEWS_CONFIG.endpoint}?orders=-publishedDate`, {
                    headers: {
                        'X-MICROCMS-API-KEY': NEWS_CONFIG.apiKey
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                renderNews(data.contents);
                
            } catch (error) {
                console.error('microCMSからのニュースデータ取得に失敗しました:', error);
                // フォールバック: 既存のHTMLをそのまま使用
                console.log('既存のHTMLコンテンツを使用します');
            }
        }

        // ニュース一覧を動的に生成
        function renderNews(newsItems) {
            const newsList = document.querySelector('.news-list');
            if (!newsList) return;

            // 既存のコンテンツをクリア
            newsList.innerHTML = '';

            if (!newsItems || newsItems.length === 0) {
                newsList.innerHTML = '<p style="text-align: center; color: #666;">ニュースがありません。</p>';
                return;
            }

            newsItems.forEach(item => {
                const newsItem = createNewsItem(item);
                newsList.appendChild(newsItem);
            });
        }

        // ニュースアイテムを作成
        function createNewsItem(item) {
            const newsItem = document.createElement('div');
            const hasImage = item.thumbnail && item.thumbnail.url;
            
            // 画像の有無によってクラスを切り替え
            newsItem.className = hasImage ? 'news-item with-image' : 'news-item without-image';
            
            // 日付をフォーマット
            const publishedDate = new Date(item.publishedDate || item.publishedAt);
            const formattedDate = formatDate(publishedDate);
            
            let newsHTML = '';
            
            if (hasImage) {
                // 画像付きレイアウト
                newsHTML = `
                    <div class="news-thumbnail">
                        <img src="${item.thumbnail.url}" alt="${item.title}" loading="lazy">
                    </div>
                    <div class="news-content">
                        <div class="news-date">
                            <time datetime="${item.publishedDate || item.publishedAt}">${formattedDate}</time>
                        </div>
                        <h2 class="news-title">${item.title}</h2>
                        <div class="news-content-text">${item.content || ''}</div>
                    </div>
                `;
            } else {
                // 画像なしレイアウト
                newsHTML = `
                    <div class="news-no-image">
                        NO IMAGE
                    </div>
                    <div class="news-content">
                        <div class="news-date">
                            <time datetime="${item.publishedDate || item.publishedAt}">${formattedDate}</time>
                        </div>
                        <h2 class="news-title">${item.title}</h2>
                        <div class="news-content-text">${item.content || ''}</div>
                    </div>
                `;
            }
            
            newsItem.innerHTML = newsHTML;
            return newsItem;
        }

        // 日付をフォーマット
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}.${month}.${day}`;
        }

        // ページ読み込み時に実行
        document.addEventListener('DOMContentLoaded', function() {
            loadNewsFromMicroCMS();
        });
    </script>
</body>
</html>
